<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Spotify Clone (Covers + Realâ€‘time Previews)</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css" />
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; }

    :root {
      --sidebar-bg: #000000; --main-bg: #121212; --player-bg: #181818; --text-primary: #ffffff; --text-secondary: #b3b3b3; --highlight: #1db954; --card-bg: #282828; --topbar-bg: #121212cc;
    }

    body { background-color: var(--main-bg); color: var(--text-primary); display: grid; grid-template-rows: auto 1fr auto; height: 100vh; overflow: hidden; }
    .container { display: grid; grid-template-columns: 240px 1fr; height: 100%; }

    /* Navigation Bar */
    .nav-bar { background-color: var(--topbar-bg); padding: 16px 30px; position: sticky; top: 0; z-index: 1000; display: flex; justify-content: space-between; align-items: center; backdrop-filter: blur(10px); border-bottom: 1px solid #282828; }
    .nav-buttons { display: flex; gap: 15px; }
    .nav-button { background-color: rgba(0,0,0,0.5); color: var(--text-primary); border: none; border-radius: 50%; width: 32px; height: 32px; display: flex; align-items: center; justify-content: center; cursor: pointer; }
    .nav-search { display: flex; align-items: center; background: rgba(255, 255, 255, 0.1); border-radius: 20px; padding: 8px 15px; width: 300px; }
    .nav-search input { background: transparent; border: none; color: var(--text-primary); outline: none; width: 100%; margin-left: 8px; }
    .nav-user { display: flex; align-items: center; gap: 8px; cursor: pointer; padding: 4px 8px; border-radius: 20px; background: rgba(0,0,0,0.5); }
    .nav-user img { width: 28px; height: 28px; border-radius: 50%; object-fit: cover; }
    .nav-user span { font-size: 14px; font-weight: 600; }

    /* Sidebar */
    .sidebar { background-color: var(--sidebar-bg); padding: 20px 10px; overflow-y: auto; }
    .logo { padding: 0 12px; margin-bottom: 20px; display: flex; align-items: center; }
    .logo i { color: var(--highlight); font-size: 32px; margin-right: 10px; }
    .logo span { font-size: 24px; font-weight: bold; }

    .nav-item { padding: 12px; margin: 4px 0; border-radius: 5px; cursor: pointer; display: flex; align-items: center; color: var(--text-secondary); transition: all 0.2s; }
    .nav-item:hover { color: var(--text-primary); background-color: #121212; }
    .nav-item.active { color: var(--text-primary); background-color: #333; }
    .nav-item i { margin-right: 15px; font-size: 18px; }
    .library { margin-top: 25px; }
    .divider { height: 1px; background-color: #282828; margin: 15px 0; }

    /* Main */
    .main-content { padding: 20px 30px; overflow-y: auto; background: linear-gradient(180deg, #2d1b69 0%, #121212 20%); }
    .topbar { display: flex; justify-content: space-between; align-items: center; margin-bottom: 25px; }
    .topbar-title { font-size: 28px; font-weight: 800; }

    .section-title { font-size: 24px; margin-bottom: 14px; font-weight: 700; }
    .controls-row { display: flex; gap: 10px; align-items: center; margin-bottom: 18px; flex-wrap: wrap; }
    .pill { background:#282828; color:#fff; border:0; padding:8px 14px; border-radius: 999px; cursor:pointer; font-size:14px; }
    .pill.active { background: var(--highlight); color:#000; }

    .album-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(180px, 1fr)); gap: 20px; margin-bottom: 26px; }
    .album-card { background-color: var(--card-bg); border-radius: 10px; padding: 14px; transition: transform .2s, background .2s; cursor: pointer; position: relative; }
    .album-card:hover { background-color: #333; transform: translateY(-4px); }
    .album-cover { width: 100%; aspect-ratio: 1; border-radius: 6px; margin-bottom: 12px; background-size: cover; background-position: center; box-shadow: 0 8px 16px rgba(0,0,0,.3); }
    .album-title { font-weight: 700; font-size: 15px; margin-bottom: 6px; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
    .album-artist { color: var(--text-secondary); font-size: 13px; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
    .play-overlay { position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); background: var(--highlight); width: 48px; height: 48px; border-radius: 50%; display: flex; align-items: center; justify-content: center; opacity: 0; transition: opacity 0.3s, transform 0.3s; box-shadow: 0 8px 16px rgba(0,0,0,.5); }
    .album-card:hover .play-overlay { opacity: 1; transform: translate(-50%, -50%) scale(1.05); }
    .play-overlay i { color: #000; font-size: 20px; margin-left: 3px; }

    .badges { display:flex; gap:6px; margin-top:8px; }
    .badge { font-size:10px; background:#1a1a1a; color:#bfbfbf; padding:3px 6px; border-radius:999px; border:1px solid #2b2b2b; }

    /* Player */
    .player { background-color: var(--player-bg); border-top: 1px solid #282828; padding: 15px 30px; display: flex; align-items: center; justify-content: space-between; gap: 16px; }
    .current-track { display: flex; align-items: center; gap: 15px; width: 30%; }
    .track-info { display: flex; flex-direction: column; }
    .track-name { font-size: 14px; font-weight: 600; }
    .artist-name { font-size: 12px; color: var(--text-secondary); }
    .small-cover { width: 56px; height: 56px; border-radius: 6px; background-size: cover; background-position: center; }

    .player-controls { display: flex; flex-direction: column; align-items: center; width: 40%; }
    .control-buttons { display: flex; align-items: center; gap: 18px; margin-bottom: 10px; }
    .control-button { color: var(--text-secondary); border: none; background: transparent; font-size: 16px; cursor: pointer; transition: color .2s, transform .2s; }
    .control-button:hover { color: var(--text-primary); }
    .control-button.play { color: var(--text-primary); font-size: 32px; }
    .control-button.play:hover { transform: scale(1.05); }

    .progress-bar { display: flex; align-items: center; gap: 10px; width: 100%; }
    .progress-time { font-size: 12px; color: var(--text-secondary); width: 40px; text-align: center; }
    .progress { flex-grow: 1; height: 4px; background-color: #535353; border-radius: 2px; position: relative; cursor: pointer; }
    .progress-fill { position: absolute; left: 0; top: 0; height: 100%; width: 0%; background-color: var(--text-primary); border-radius: 2px; }
    .progress-fill:hover { background-color: var(--highlight); }

    .volume-controls { display: flex; align-items: center; gap: 10px; width: 30%; justify-content: flex-end; }
    .volume-bar { width: 120px; height: 4px; background-color: #535353; border-radius: 2px; position: relative; cursor: pointer; }
    .volume-fill { position: absolute; left: 0; top: 0; height: 100%; width: 70%; background-color: var(--text-primary); border-radius: 2px; }

    .loader { display: flex; justify-content: center; align-items: center; height: 160px; }
    .spinner { width: 36px; height: 36px; border: 4px solid rgba(255,255,255,.12); border-left-color: var(--highlight); border-radius: 50%; animation: spin 1s linear infinite; }
    @keyframes spin { to { transform: rotate(360deg); } }
    .no-tracks { grid-column: 1 / -1; text-align: center; padding: 40px; color: var(--text-secondary); }

    /* Now Playing Tab */
    .now-playing-tab { position: fixed; bottom: 90px; right: 20px; width: 300px; background: var(--card-bg); border-radius: 8px; box-shadow: 0 -4px 20px rgba(0,0,0,0.5); z-index: 999; transform: translateY(100%); transition: transform 0.3s ease; }
    .now-playing-tab.active { transform: translateY(0); }
    .now-playing-header { padding: 15px; border-bottom: 1px solid #333; display: flex; justify-content: space-between; align-items: center; }
    .now-playing-header h3 { font-size: 16px; }
    .now-playing-header button { background: none; border: none; color: var(--text-secondary); cursor: pointer; }
    .now-playing-list { max-height: 300px; overflow-y: auto; }
    .now-playing-item { padding: 10px 15px; display: flex; align-items: center; gap: 10px; border-bottom: 1px solid #333; cursor: pointer; }
    .now-playing-item:hover { background: #333; }
    .now-playing-item.active { background: rgba(29, 185, 84, 0.2); }
    .now-playing-item img { width: 40px; height: 40px; border-radius: 4px; object-fit: cover; }
    .now-playing-info { flex: 1; }
    .now-playing-info .track-name { font-size: 14px; }
    .now-playing-info .artist-name { font-size: 12px; }

    @media (max-width: 860px) {
      .container { grid-template-columns: 1fr; }
      .sidebar { display: none; }
      .album-grid { grid-template-columns: repeat(auto-fill, minmax(140px, 1fr)); }
      .current-track, .volume-controls { width: 25%; }
      .player-controls { width: 50%; }
      .nav-search { width: 200px; }
      .now-playing-tab { width: 250px; }
    }
  </style>
</head>
<body>
  <!-- Navigation Bar -->
  <nav class="nav-bar">
    <div class="nav-buttons">
      <button class="nav-button" id="nav-back"><i class="fas fa-chevron-left"></i></button>
      <button class="nav-button" id="nav-forward"><i class="fas fa-chevron-right"></i></button>
    </div>
    <div class="nav-search">
      <i class="fas fa-search"></i>
      <input type="text" placeholder="Search for Artists, Songs, or Albums" id="search-input">
    </div>
    <div class="nav-user">
      <img src="https://i.pravatar.cc/150?u=spotify-user" alt="User">
      <span>John Doe</span>
      <i class="fas fa-caret-down"></i>
    </div>
  </nav>

  <div class="container">
    <!-- Sidebar -->
    <aside class="sidebar">
      <div class="logo"><i class="fab fa-spotify"></i><span>Spotify</span></div>
      <div class="nav-item active"><i class="fas fa-home"></i><span>Home</span></div>
      <div class="nav-item"><i class="fas fa-search"></i><span>Search</span></div>
      <div class="nav-item"><i class="fas fa-book"></i><span>Your Library</span></div>
      <div class="library">
        <div class="nav-item"><i class="fas fa-plus-square"></i><span>Create Playlist</span></div>
        <div class="nav-item"><i class="fas fa-heart"></i><span>Liked Songs</span></div>
      </div>
      <div class="divider"></div>
      <div class="playlists" id="genre-playlists">
        <div class="nav-item" data-genre="all">All Hits</div>
        <div class="nav-item" data-genre="pop">Pop Hits</div>
        <div class="nav-item" data-genre="rock">Rock Classics</div>
        <div class="nav-item" data-genre="hiphop">Hip-Hop Essentials</div>
      </div>
    </aside>

    <!-- Main Content -->
    <main class="main-content">
      <div class="topbar">
        <h1 class="topbar-title">Good evening</h1>
        <button class="pill" id="queue-btn"><i class="fas fa-bars"></i> Queue</button>
      </div>

      <div class="controls-row">
        <button class="pill active" data-genre="all">All</button>
        <button class="pill" data-genre="pop">Pop</button>
        <button class="pill" data-genre="rock">Rock</button>
        <button class="pill" data-genre="hiphop">Hip-Hop</button>
      </div>

      <h2 class="section-title">All Tracks</h2>
      <div id="tracks-grid" class="album-grid">
        <div class="loader"><div class="spinner"></div></div>
      </div>
    </main>
  </div>

  <!-- Now Playing Tab -->
  <div class="now-playing-tab" id="now-playing-tab">
    <div class="now-playing-header">
      <h3>Queue</h3>
      <button id="close-queue"><i class="fas fa-times"></i></button>
    </div>
    <div class="now-playing-list" id="now-playing-list">
      <!-- Queue items will be added here -->
    </div>
  </div>

  <!-- Player -->
  <footer class="player">
    <div class="current-track">
      <div class="small-cover" id="current-cover"></div>
      <div class="track-info">
        <div class="track-name" id="current-title">Pick a song</div>
        <div class="artist-name" id="current-artist">-</div>
      </div>
      <i class="fas fa-heart"></i>
    </div>

    <div class="player-controls">
      <div class="control-buttons">
        <button class="control-button" id="shuffle-btn" title="Shuffle"><i class="fas fa-random"></i></button>
        <button class="control-button" id="prev-btn" title="Previous"><i class="fas fa-step-backward"></i></button>
        <button class="control-button play" id="play-btn" title="Play/Pause"><i class="fas fa-play-circle"></i></button>
        <button class="control-button" id="next-btn" title="Next"><i class="fas fa-step-forward"></i></button>
        <button class="control-button" id="repeat-btn" title="Repeat"><i class="fas fa-repeat"></i></button>
      </div>
      <div class="progress-bar">
        <span class="progress-time" id="current-time">0:00</span>
        <div class="progress" id="progress"><div class="progress-fill" id="progress-fill"></div></div>
        <span class="progress-time" id="total-time">0:00</span>
      </div>
    </div>

    <div class="volume-controls">
      <i class="fas fa-volume-up"></i>
      <div class="volume-bar" id="volume-bar"><div class="volume-fill" id="volume-fill"></div></div>
    </div>
  </footer>

  <audio id="audio" crossorigin="anonymous"></audio>

  <script>
    const audio = document.getElementById('audio');
    const tracksGrid = document.getElementById('tracks-grid');
    const currentCover = document.getElementById('current-cover');
    const currentTitle = document.getElementById('current-title');
    const currentArtist = document.getElementById('current-artist');
    const playBtn = document.getElementById('play-btn');
    const prevBtn = document.getElementById('prev-btn');
    const nextBtn = document.getElementById('next-btn');
    const shuffleBtn = document.getElementById('shuffle-btn');
    const repeatBtn = document.getElementById('repeat-btn');
    const progress = document.getElementById('progress');
    const progressFill = document.getElementById('progress-fill');
    const currentTimeEl = document.getElementById('current-time');
    const totalTimeEl = document.getElementById('total-time');
    const volumeBar = document.getElementById('volume-bar');
    const volumeFill = document.getElementById('volume-fill');
    const genreButtons = Array.from(document.querySelectorAll('.pill'));
    const sidebarGenres = Array.from(document.querySelectorAll('#genre-playlists .nav-item[data-genre]'));
    const queueBtn = document.getElementById('queue-btn');
    const nowPlayingTab = document.getElementById('now-playing-tab');
    const closeQueueBtn = document.getElementById('close-queue');
    const nowPlayingList = document.getElementById('now-playing-list');
    const searchInput = document.getElementById('search-input');

    let masterList = [];
    let filteredList = [];
    let currentIndex = -1;
    let isPlaying = false;
    let isShuffle = false;
    let isRepeat = false;
    let playedTracks = new Set(); // Track played songs to avoid duplicates

    function fmt(sec) {
      if (!Number.isFinite(sec)) return '0:00';
      const m = Math.floor(sec / 60);
      const s = Math.floor(sec % 60);
      return `${m}:${s < 10 ? '0' : ''}${s}`;
    }

    function dedupeBy(list, key) {
      const seen = new Set();
      const out = [];
      for (const item of list) {
        const k = item[key];
        // Check if we've seen this track before and if it has a unique cover
        if (k && !seen.has(k) && !playedTracks.has(item.preview)) {
          seen.add(k);
          playedTracks.add(item.preview);
          out.push(item);
        }
      }
      return out;
    }

    function renderGrid(list) {
      if (!list.length) {
        tracksGrid.innerHTML = '<div class="no-tracks">No tracks found. Try another filter.</div>';
        return;
      }
      tracksGrid.innerHTML = '';
      list.forEach((t, idx) => {
        const card = document.createElement('div');
        card.className = 'album-card';
        card.innerHTML = `
          <div class="album-cover" style="background-image:url(${t.cover})"></div>
          <div class="play-overlay">
            <i class="fas fa-play"></i>
          </div>
          <div class="album-title" title="${t.title}">${t.title}</div>
          <div class="album-artist" title="${t.artist}">${t.artist}</div>
          <div class="badges">
            <span class="badge">${t.primaryGenre || 'Song'}</span>
            <span class="badge">${t.country || 'US'}</span>
          </div>
        `;
        card.addEventListener('click', () => playIndex(idx));
        tracksGrid.appendChild(card);
      });
    }

    function updatePlayerUI(track) {
      currentCover.style.backgroundImage = `url(${track.cover})`;
      currentTitle.textContent = track.title;
      currentArtist.textContent = track.artist;
    }

    function updateQueueList() {
      nowPlayingList.innerHTML = '';
      filteredList.forEach((track, index) => {
        const item = document.createElement('div');
        item.className = `now-playing-item ${index === currentIndex ? 'active' : ''}`;
        item.innerHTML = `
          <img src="${track.cover}" alt="${track.title}">
          <div class="now-playing-info">
            <div class="track-name">${track.title}</div>
            <div class="artist-name">${track.artist}</div>
          </div>
        `;
        item.addEventListener('click', () => playIndex(index));
        nowPlayingList.appendChild(item);
      });
    }

    async function playIndex(idx) {
      if (idx < 0 || idx >= filteredList.length) return;
      currentIndex = idx;
      const track = filteredList[currentIndex];
      updatePlayerUI(track);
      
      // Reset audio and set new source
      audio.pause();
      audio.src = track.preview;
      audio.currentTime = 0; // Always start from the beginning
      
      try {
        await audio.play();
        isPlaying = true;
        playBtn.innerHTML = '<i class="fas fa-pause-circle"></i>';
        updateQueueList();
      } catch (error) {
        console.error('Playback failed:', error);
      }
    }

    function togglePlay() {
      if (currentIndex === -1 && filteredList.length) return playIndex(0);
      if (!filteredList.length) return;
      if (isPlaying) { 
        audio.pause(); 
        isPlaying = false; 
        playBtn.innerHTML = '<i class="fas fa-play-circle"></i>'; 
      } else { 
        audio.play(); 
        isPlaying = true; 
        playBtn.innerHTML = '<i class="fas fa-pause-circle"></i>'; 
      }
    }

    function nextTrack() {
      if (!filteredList.length) return;
      if (isShuffle) {
        const r = Math.floor(Math.random() * filteredList.length);
        return playIndex(r);
      }
      const next = (currentIndex + 1) % filteredList.length;
      playIndex(next);
    }

    function prevTrack() {
      if (!filteredList.length) return;
      const prev = (currentIndex - 1 + filteredList.length) % filteredList.length;
      playIndex(prev);
    }

    function setGenre(genre) {
      genreButtons.forEach(b => b.classList.toggle('active', b.dataset.genre === genre));
      filteredList = genre === 'all' ? masterList.slice() : masterList.filter(t => (t.genreKey || '').includes(genre));
      renderGrid(filteredList);
      updateQueueList();
      
      // keep current playing if exists; otherwise reset UI art
      if (currentIndex === -1 && filteredList[0]) {
        currentCover.style.backgroundImage = `url(${filteredList[0].cover})`;
      }
    }

    function attachUIEvents() {
      playBtn.addEventListener('click', togglePlay);
      nextBtn.addEventListener('click', nextTrack);
      prevBtn.addEventListener('click', prevTrack);
      shuffleBtn.addEventListener('click', () => { 
        isShuffle = !isShuffle; 
        shuffleBtn.style.color = isShuffle ? 'var(--highlight)' : 'var(--text-secondary)'; 
      });
      repeatBtn.addEventListener('click', () => { 
        isRepeat = !isRepeat; 
        repeatBtn.style.color = isRepeat ? 'var(--highlight)' : 'var(--text-secondary)'; 
      });

      // Queue button
      queueBtn.addEventListener('click', () => {
        nowPlayingTab.classList.toggle('active');
      });
      
      closeQueueBtn.addEventListener('click', () => {
        nowPlayingTab.classList.remove('active');
      });

      // Search functionality
      searchInput.addEventListener('input', (e) => {
        const searchTerm = e.target.value.toLowerCase();
        if (searchTerm.length > 2) {
          filteredList = masterList.filter(track => 
            track.title.toLowerCase().includes(searchTerm) || 
            track.artist.toLowerCase().includes(searchTerm)
          );
          renderGrid(filteredList);
        } else if (searchTerm.length === 0) {
          setGenre('all');
        }
      });

      // Navigation buttons
      document.getElementById('nav-back').addEventListener('click', () => {
        window.scrollBy(0, -window.innerHeight * 0.8);
      });
      
      document.getElementById('nav-forward').addEventListener('click', () => {
        window.scrollBy(0, window.innerHeight * 0.8);
      });

      // progress seek (click + drag)
      let seeking = false;
      function seekTo(clientX) {
        if (!Number.isFinite(audio.duration)) return;
        const rect = progress.getBoundingClientRect();
        const ratio = Math.max(0, Math.min(1, (clientX - rect.left) / rect.width));
        audio.currentTime = ratio * audio.duration;
      }
      progress.addEventListener('mousedown', (e) => { seeking = true; seekTo(e.clientX); });
      window.addEventListener('mousemove', (e) => { if (seeking) seekTo(e.clientX); });
      window.addEventListener('mouseup', () => { seeking = false; });

      // volume
      function setVolumeAt(clientX) {
        const rect = volumeBar.getBoundingClientRect();
        const r = Math.max(0, Math.min(1, (clientX - rect.left) / rect.width));
        audio.volume = r; 
        volumeFill.style.width = (r * 100) + '%';
      }
      volumeBar.addEventListener('click', (e) => setVolumeAt(e.clientX));

      // audio events
      audio.addEventListener('timeupdate', () => {
        if (!Number.isFinite(audio.duration)) return;
        const pct = (audio.currentTime / audio.duration) * 100;
        progressFill.style.width = pct + '%';
        currentTimeEl.textContent = fmt(audio.currentTime);
      });
      
      audio.addEventListener('loadedmetadata', () => {
        totalTimeEl.textContent = fmt(audio.duration);
        // Ensure playback starts from the beginning
        if (audio.currentTime > 0) {
          audio.currentTime = 0;
        }
      });
      
      audio.addEventListener('ended', () => {
        if (isRepeat) { 
          audio.currentTime = 0; 
          audio.play(); 
          return; 
        }
        nextTrack();
      });
    }

    // -------- Data fetching --------
    const SEEDS = {
      all: [
        'top hits', 'global 100', 'chart toppers',
        'The Weeknd', 'Dua Lipa', 'Taylor Swift', 'Drake', 'Ed Sheeran', 'Ariana Grande',
        'Queen', 'Nirvana', 'AC/DC', 'Eagles', 'Guns N\' Roses', 'Led Zeppelin',
        'Kendrick Lamar', 'Travis Scott', 'J. Cole', 'Eminem', '50 Cent'
      ],
      pop: ['Taylor Swift', 'Dua Lipa', 'Harry Styles', 'Ariana Grande', 'Olivia Rodrigo', 'Katy Perry', 'Sia'],
      rock: ['Queen', 'Led Zeppelin', 'Nirvana', 'AC/DC', 'Eagles', 'Bon Jovi', 'Metallica'],
      hiphop: ['Drake', 'Kendrick Lamar', 'Travis Scott', 'J. Cole', 'Eminem', 'Future', 'Lil Wayne']
    };

    async function itunesSearch(term, limit = 25) {
      const url = `https://itunes.apple.com/search?term=${encodeURIComponent(term)}&entity=song&limit=${limit}`;
      const res = await fetch(url);
      const data = await res.json();
      return (data.results || []).map(r => ({
        id: r.trackId,
        title: r.trackName,
        artist: r.artistName,
        preview: r.previewUrl,
        cover: (r.artworkUrl100 || '').replace('100x100', '512x512'),
        primaryGenre: r.primaryGenreName,
        country: r.country || 'US',
        genreKey: (r.primaryGenreName || '').toLowerCase()
      })).filter(x => x.preview && x.cover && x.title && x.artist);
    }

    async function loadMany(genre = 'all') {
      tracksGrid.innerHTML = '<div class="loader"><div class="spinner"></div></div>';
      const seeds = genre === 'all' ? SEEDS.all : SEEDS[genre];
      const batches = await Promise.all(seeds.map(s => itunesSearch(s, 20)));
      
      // Reset played tracks when loading new genre
      if (genre !== 'all') playedTracks.clear();
      
      // flatten + dedupe by track id (or preview)
      let combined = batches.flat();
      combined = dedupeBy(combined, 'id');
      
      // keep only first 150 items to avoid a super heavy DOM
      combined = combined.slice(0, 150);
      masterList = combined;
      setGenre(genre);
    }

    // -------- init --------
    attachUIEvents();
    loadMany('all');

    // genre controls
    genreButtons.forEach(b => b.addEventListener('click', () => {
      if (b.dataset.genre) loadMany(b.dataset.genre);
    }));
    
    sidebarGenres.forEach(b => b.addEventListener('click', () => loadMany(b.dataset.genre)));
  </script>
</body>
</html>
